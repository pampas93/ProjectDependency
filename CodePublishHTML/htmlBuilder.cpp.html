<!----------------------------------------------------------------------------
htmlBuilder.cpp Help file for Project #3
 Published 4 Apr 2017
 Abhijit Srikanth, CSE687 - Object Oriented Design, Spring 2017

 The below file is the webpage of the source code for htmlBuilder.cpp and holds links to its dependent files

 Note -Do not replace any markup characters with escape sequences
----------------------------------------------------------------------------->
<html>
<head>
<link rel = "stylesheet"type = "text/css"href = "../CodePublishHTML/myStyle.css" /></head>
<body class = "indent">
<script type="text/javascript" src="../CodePublishHTML/jquery-2.2.4.js"></script>
<script type="text/javascript" src="../CodePublishHTML/myJS.js"></script><h3>htmlBuilder.cpp</h3>
<hr><div class = "indent"><h4>Dependencies :</h4><ul><li> <a href="../CodePublishHTML/htmlBuilder.h.html">htmlBuilder.h</a> </li><li> <a href="../CodePublishHTML/DependencyAnalysis.h.html">DependencyAnalysis.h</a> </li><li> <a href="../CodePublishHTML/FileSystem.h.html">FileSystem.h</a> </li><li> <a href="../CodePublishHTML/NoSqlDb.h.html">NoSqlDb.h</a> </li><li> <a href="../CodePublishHTML/typetable.h.html">typetable.h</a> </li><li> <a href="../CodePublishHTML/SCC.h.html">SCC.h</a> </li><li> <a href="../CodePublishHTML/Display.h.html">Display.h</a> </li>
</ul></div><hr>
<pre>
/////////////////////////////////////////////////////////////////////
//  HtmlBuilder.cpp - Webpage CodePublisher					       //
//																   //
//  Language:      Visual C++ 2015                                 //
//  Platform:      Dell Inspiron, Windows 8.1			           //
//  Application:   Dependency Analysis - CIS 687 Project 3         //
//  Author:        Abhijit Srikanth SUID:864888072			       //
/////////////////////////////////////////////////////////////////////

#include "htmlBuilder.h"

using namespace CodeAnalysis;

//&lt;---------------------- Main Function to begin the CodePublisher -------------------&gt;
std::string htmlClass::htmlMainClass(DependencyTable dp, std::string dirPath, std::unordered_map &lt; std::string, lineVector&gt; linemap)
<div class="header">-  {</div><div class="content">
	lineMap = linemap;
	std::string indexFile;
	try {
		directoryPath = dirPath;
		const char *c = directoryPath.c_str();
		_mkdir(c);
		file2Path = dp.funcFile2Path();
		dp_Store = dp.getDb();				//dp_store is a noSql db

		addFilesToDir();
		indexFile = indexPage();

	}
	catch (const std::exception& e)
	{
		std::cout &lt;&lt; e.what();
	}
	return indexFile;
</div>}

//&lt;---------------------- Function to add Files into new Directory -------------------&gt;
void htmlClass::addFilesToDir()
<div class="header">-  {</div><div class="content">
	std::string newPath;
	for (Item item : file2Path)
	{
		newPath = directoryPath +"/"+ item.first + ".html";
		createHTMLfile(newPath, item.second);
		std::string f = FileSystem::Path::getName(newPath);
		newPath = "file:///" + FileSystem::Path::getFullFileSpec(newPath);
		htmlFile2Path[f] = newPath;
	}
	
</div>}

//&lt;---------------------- Function to copy source code into html file -------------------&gt;
std::string htmlClass::copyFile(Path path1)
<div class="header">-  {</div><div class="content">
	lineNumber = 1;
	std::ifstream document1(path1);
	//std::ofstream document2(path2);
	std::string sourceCode;
	try {
		
		std::string str;
		while (getline(document1, str))
		{
			sourceCode.append(replaceEscSeq(str, path1));
			sourceCode.append("\n");
			lineNumber++;
			//document2 &lt;&lt; replaceEscSeq(str) &lt;&lt; std::endl;
		}
		document1.close();
	}
	catch (const std::exception& e)
	{
		std::cout &lt;&lt; e.what();
	}
	//	document2.close();
	return sourceCode;
</div>}

//&lt;---------------------- Function to check and replace escapse sequence characters -------------------&gt;
std::string htmlClass::replaceEscSeq(std::string str, std::string path)
<div class="header">-  {</div><div class="content">
	bool flag = true;
	std::string temp;
	for (char a : str)
	{
		if (a == '&lt;')
			temp.append("&lt;");
		else if (a == '&gt;')
			temp.append("&gt;");
		else if (a == '{') {
			if (isOpenBracePresent(path)) {
				temp.append("&lt;div class=\"header\"&gt;-  {&lt;/div&gt;");
				temp.append("&lt;div class=\"content\"&gt;");
				myStack.push('{');
			}
			else
				temp += a;
		}
		else if (a == '}') {
			if (isCloseBracePresent(path)) {
				temp.append("&lt;/div&gt;}");
			}
			else
				temp += a;
		}
		else
			temp += a;
	}
	return temp;
</div>}

//&lt;---------------------- Function to create html file and add the required tags -------------------&gt;
void htmlClass::createHTMLfile(Path htmlPath, Path sourcePath)
<div class="header">-  {</div><div class="content">
	try {
		std::string openHtmlTags;
		openHtmlTags = "&lt;html&gt;\n&lt;head&gt;\n&lt;link rel = \"stylesheet\"type = \"text/css\"href = \"../CodePublishHTML/myStyle.css\" /&gt;&lt;/head&gt;\n&lt;body class = \"indent\"&gt;\n&lt;script type=\"text/javascript\" src=\"../CodePublishHTML/jquery-2.2.4.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"../CodePublishHTML/myJS.js\"&gt;&lt;/script&gt;";
		std::string closeHtmlTags;
		closeHtmlTags = "\n&lt;/body&gt;\n&lt;/html&gt;";

		std::ofstream doc(htmlPath);
		doc &lt;&lt; htmlPrologues(FileSystem::Path::getName(sourcePath));
		doc &lt;&lt; openHtmlTags;

		doc &lt;&lt; "&lt;h3&gt;" &lt;&lt; FileSystem::Path::getName(sourcePath) &lt;&lt; "&lt;/h3&gt;";

		doc &lt;&lt; "\n&lt;hr&gt;&lt;div class = \"indent\"&gt;&lt;h4&gt;" &lt;&lt; "Dependencies :" &lt;&lt; "&lt;/h4&gt;";
		std::string deplist = returnDependencyHRef(sourcePath);

		doc &lt;&lt; "&lt;ul&gt;" &lt;&lt; deplist &lt;&lt; "\n&lt;/ul&gt;&lt;/div&gt;&lt;hr&gt;";

		std::string sourceCode = copyFile(sourcePath);
		doc &lt;&lt; std::endl;
		doc &lt;&lt; "&lt;pre&gt;\n" &lt;&lt; sourceCode &lt;&lt; "&lt;/pre&gt;";

		doc &lt;&lt; closeHtmlTags;
		doc.close();
	}
	catch (const std::exception& e)
	{
		std::cout &lt;&lt; e.what();
	}
</div>}

//&lt;---------------------- Function that returns a html text of dependencies of a file -------------------&gt;
std::string htmlClass::returnDependencyHRef(Path sourcePath)
<div class="header">-  {</div><div class="content">
	std::string htmlDepTags;
	NoSQLDB::Element&lt;std::string&gt; depList = dp_Store.value(sourcePath);
	for (File child : depList.dependencies.getValue())
	{
		std::string filename = FileSystem::Path::getName(child);
		std::string link = directoryPath + "/" +filename+ ".html";
		htmlDepTags.append("&lt;li&gt; &lt;a href=");
		htmlDepTags.append("\""+link + "\"&gt;");
		htmlDepTags.append(filename + "&lt;/a&gt; &lt;/li&gt;");
	}

	return htmlDepTags;
</div>}

//&lt;---------------------- Function to check if { is inside comment -------------------&gt;

//&lt;---------------------- Function to add Prologues into html file -------------------&gt;
std::string htmlClass::htmlPrologues(std::string fn)
<div class="header">-  {</div><div class="content">
	std::string prologue;
	prologue = "&lt;!----------------------------------------------------------------------------\n" + fn+" Help file for Project #3\n Published 4 Apr 2017\n Abhijit Srikanth, CSE687 - Object Oriented Design, Spring 2017\n";
	prologue.append("\n The below file is the webpage of the source code for " + fn + " and holds links to its dependent files\n");
	prologue.append("\n Note -Do not replace any markup characters with escape sequences\n");
	prologue.append("-----------------------------------------------------------------------------&gt;\n");
	return prologue;
</div>}

//&lt;---------------------- Function to create index page -------------------&gt;
std::string htmlClass::indexPage()
<div class="header">-  {</div><div class="content">
	std::string openHtmlTags = "&lt;html&gt;\n&lt;head&gt;\n&lt;link rel = \"stylesheet\"type = \"text/css\"href = \"../CodePublishHTML/myStyle.css\" /&gt;&lt;/head&gt;\n&lt;body class = \"indent\"&gt;\n&lt;script type=\"text/javascript\" src=\"../CodePublishHTML/jquery-2.2.4.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"../CodePublishHTML/myJS.js\"&gt;&lt;/script&gt;";
	std::string closeHtmlTags = "\n&lt;/body&gt;\n&lt;/html&gt;";
	std::string prologue;
	prologue = "&lt;!----------------------------------------------------------------------------\n IndexPage.html -  Index page for webPages published for Project #3\n Published 4 Apr 2017\n Abhijit Srikanth, CSE687 - Object Oriented Design, Spring 2017\n";
	prologue.append("\n The below file is the webpage of listing all the links to source codes (published as webpages) \n");
	prologue.append("-----------------------------------------------------------------------------&gt;");

	std::string index = directoryPath + "/indexPage.html";
	try {
		std::ofstream doc(index);
		doc &lt;&lt; prologue;
		doc &lt;&lt; openHtmlTags;

		doc &lt;&lt; "&lt;h2&gt;" &lt;&lt; "Index Page" &lt;&lt; "&lt;/h2&gt;";

		std::string list;
		list.append("&lt;ul&gt;");

		for (auto item : htmlFile2Path) {
			list.append("&lt;li&gt; &lt;a href=");
			list.append("\"" + item.second + "\"&gt;");
			list.append("&lt;h3&gt;" + item.first + "&lt;/h3&gt;&lt;/a&gt; &lt;/li&gt;\n");
		}

		doc &lt;&lt; list;
		doc &lt;&lt; closeHtmlTags;
		doc.close();
	}
	catch (const std::exception& e)
	{
		std::cout &lt;&lt; e.what();
	}
	return index;
</div>}

//&lt;---------------------- Function to check if Open brace and line number matches -------------------&gt;
bool htmlClass::isOpenBracePresent(std::string f)
<div class="header">-  {</div><div class="content">
	lineVector temp = lineMap[f];
	for (auto item : temp) {
		if (item.at(0) == lineNumber)
			return true;
	}
	return false;
</div>}

//&lt;---------------------- Function to check if Close brace and line number matches -------------------&gt;
bool htmlClass::isCloseBracePresent(std::string f)
<div class="header">-  {</div><div class="content">
	lineVector temp = lineMap[f];
	for (auto item : temp) {
		if (item.at(1) == lineNumber)
			return true;
	}
	return false;
</div>}

//&lt;---------------------- htmlClass destructor -------------------&gt;
htmlClass::~htmlClass()
<div class="header">-  {</div><div class="content">

</div>}

#ifdef TEST_htmlBuilder

int main()
<div class="header">-  {</div><div class="content">
	using File = std::string;
	using Files = std::vector&lt;File&gt;;
	Files allfilePaths;

	allfilePaths.push_back("C:\\Users\\Abhijit\\Desktop\\Project2_OOD\\TestingPurpose\\TestingPurpose\\B.h");
	allfilePaths.push_back("C:\\Users\\Abhijit\\Desktop\\Project2_OOD\\TestingPurpose\\TestingPurpose\\A.h");
	allfilePaths.push_back("C:\\Users\\Abhijit\\Desktop\\Project2_OOD\\TestingPurpose\\TestingPurpose\\A.cpp");
	allfilePaths.push_back("C:\\Users\\Abhijit\\Desktop\\Project2_OOD\\TestingPurpose\\TestingPurpose\\B.cpp");

	Type_Table tb;
	tb.populateTypeTable();

	DependencyTable dp(tb.returnTypeTable(), allfilePaths);
	dp.dependencyMain();

	StronglyConnectedComps scc;
	scc.makeGraph(dp);

	Show showObj;
	showObj.showTypeTable(tb.returnTypeTable());
	showObj.showDependencyDB(dp.getDb());
	showObj.showSCC(scc.returnMatrix());
</div>}

#endif

</pre>
</body>
</html>